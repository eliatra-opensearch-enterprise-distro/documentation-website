{% assign url_parts = page.url | split: "/" %}
{% if url_parts.size > 0 %}
  
  {% assign last_url_part = url_parts | last %}

  {% comment %} Does the URL contain a filename, and is it an index.html or not? {% endcomment %}
  {% if last_url_part contains ".html" %}
    {% assign url_has_filename = true %}
    {% if last_url_part == 'index.html' %}
      {% assign url_filename_is_index = true %}
    {% else %}
      {% assign url_filename_is_index = false %}
    {% endif %}
  {% else %}
    {% assign url_has_filename = false %}
  {% endif %}

  {% comment %} 
    OpenSearchCon URLs require some special consideration, because it's a specialization
    of the /events URL which is itself a child of Community; te OpenSearchCon menu is NOT
    a child of Community.
  {% endcomment %}
  {% if page.url contains "opensearchcon" %}
    {% assign is_conference_page = true %}
  {% else %}
    {% assign is_conference_page = false %}
  {% endif %}

  {% if is_conference_page %}
    {% comment %}
      If the page is a confernce page and it has a filename then its the penultimate
      path component that has the child menu item of the OpenSearchCon that needs
      to be marked as in-category. If there's no filename then reference the ultimate
      path component.
      Unless the filename is opensearchcon2023-cfp, because it's a one off that is not
      within the /events/opensearchcon/... structure.
    {% endcomment %}
    {% if url_has_filename %}
      {% unless page.url contains 'opensearchcon2023-cfp' %}
        {% assign url_fragment_index = url_parts | size | minus: 2 %}
        {% assign url_fragment = url_parts[url_fragment_index] %}
      {% else %}
        {% assign url_fragment = 'opensearchcon2023-cfp' %}
      {% endunless %}
    {% else %}
      {% assign url_fragment = last_url_part %}
    {% endif %}
  {% else %}
    {% comment %}
      If the page is NOT a conference page, the URL has a filename, and the filename
      is NOT index.html then refer to the filename without the .html extension.
      If the filename is index.html then refer to the penultimate path component.
      If there is not filename then refer to the ultimate path component.
    {% endcomment %}
    {% if url_has_filename %}
      {% unless url_filename_is_index %}
        {% assign url_fragment = last_url_part | replace: '.html', '' %}
      {% else %}
        {% assign url_fragment_index = url_parts | size |  minus: 2 %}
        {% assign url_fragment = url_parts[url_fragment_index] %}
      {% endunless %}
    {% else %}
      {% assign url_fragment = last_url_part %}
    {% endif %}
  {% endif %}
{% else %}
  {% assign url_fragment = '' %}
{% endif %}
{% if page.alert %}
<div role="banner" class="banner-alert">
  <div class="container">
    {{ page.alert | markdownify }}
  </div>
</div>
{% endif %}
{% if site.data.alert.message %}
<div role="banner" class="banner-alert">
  <div class="container">
  {{site.data.alert.message | markdownify}}
  </div>
</div>
{% endif %}
<div role="banner" id="top">
  <div class="navigation-container">
    <a class="navigation-container--logo" href="{{ '/' }}">
      OpenSearch
      <?xml version="1.0" encoding="utf-8" standalone="yes"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">


<svg width="200" height="39" viewBox="0 0 288 56" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.99633 16.001V36.0003C7.99633 42.6294 13.3702 48.0033 19.9993 48.0033L39.9986 48.0033L39.9986 55.9996L19.9993 55.9996C8.95399 55.9996 0 47.0456 0 36.0003V16.001H7.99633Z" fill="#00796B"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.99633 2.54175e-07L7.99633 23.9975L-7.62796e-07 23.9975L0 0L7.99633 2.54175e-07Z" fill="#00796B"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M16.0012 0H19.9993C31.0446 0 39.9986 8.954 39.9986 19.9993L39.9986 31.998L8.7654e-07 31.998L0 24.0017L32.0023 24.0017L32.0023 19.9993C32.0023 13.3702 26.6284 7.99633 19.9993 7.99633H16.0012V0Z" fill="#00796B"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M63.9963 2.54175e-07L63.9963 23.9975L56 23.9975L56 0L63.9963 2.54175e-07Z" fill="#00796B"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M63.9963 16.001L63.9964 36.0003C63.9964 42.6294 69.3703 48.0033 75.9994 48.0033H79.9976V55.9996H75.9994C64.9541 55.9996 56.0001 47.0456 56.0001 36.0003L56 16.001L63.9963 16.001Z" fill="#00796B"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M99.9963 2.54175e-07L99.9963 23.9975L92 23.9975L92 0L99.9963 2.54175e-07Z" fill="#00796B"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M99.9963 16.001L99.9963 39.9985L92 39.9985L92 16.001L99.9963 16.001Z" fill="#00796B"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M99.9963 32.0024L99.9963 55.9999L92 55.9999L92 32.0024L99.9963 32.0024Z" fill="#00796B"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M148.008 39.999L148.008 19.9997C148.008 13.3706 142.634 7.99673 136.005 7.99673L116.005 7.99673L116.005 0.000401367L136.005 0.00039961C147.05 0.000400575 156.004 8.95439 156.004 19.9997L156.004 39.999L148.008 39.999Z" fill="#00796B"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M148.008 56.0005L148.008 32.003L156.004 32.003L156.004 56.0005L148.008 56.0005Z" fill="#00796B"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M140.003 56.0005L136.005 56.0005C124.959 56.0005 116.005 47.0465 116.005 36.0012L116.005 24.0025L156.004 24.0025L156.004 31.9988L124.002 31.9988L124.002 36.0012C124.002 42.6302 129.376 48.0042 136.005 48.0042L140.003 48.0042L140.003 56.0005Z" fill="#00796B"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M280 56.0005L280 32.003L287.996 32.003L287.996 56.0005L280 56.0005Z" fill="#00796B"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M280.004 39.999L280.004 19.9997C280.004 13.3706 274.63 7.99673 268.001 7.99673L248.001 7.99673L248.001 0.000401367L268.001 0.00039961C279.046 0.000400575 288 8.95439 288 19.9997L288 39.999L280.004 39.999Z" fill="#00796B"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M271.999 56.0005L268.001 56.0005C256.955 56.0005 248.001 47.0465 248.001 36.0012L248.001 24.0025L288 24.0025L288 31.9988L255.998 31.9988L255.998 36.0012C255.998 42.6302 261.372 48.0042 268.001 48.0042L271.999 48.0042L271.999 56.0005Z" fill="#00796B"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M219.996 56L219.996 32.0025L212 32.0025L212 56L219.996 56Z" fill="#00796B"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M212 19.9993C212 8.954 220.954 0 231.999 0H235.997V7.99633H231.999C225.37 7.99633 219.996 13.3702 219.996 19.9993L219.996 39.9986L212 39.9986L212 19.9993Z" fill="#00796B"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M188 2.54175e-07L188 23.9975L180.004 23.9975L180.004 0L188 2.54175e-07Z" fill="#00796B"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M188 16.001L188 39.9985L180.004 39.9985L180.004 16.001L188 16.001Z" fill="#00796B"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M188 32.0024L188 55.9999L180.004 55.9999L180.004 32.0024L188 32.0024Z" fill="#00796B"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M204 7.99658L180.003 7.99658L180.003 0.000250533L204 0.000250533L204 7.99658Z" fill="#00796B"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M187.996 7.99658L163.999 7.99658L163.999 0.000250533L187.996 0.000250533L187.996 7.99658Z" fill="#00796B"/>
  </svg>
  



    </a>
    <div class="menu-button">
      <i class="icon icon-reorder"></i>
      <i class="icon icon-close"></i>
      <span>Menu</span>
    </div>
    <div role="navigation" class="navigation-container--nested-nav-wrapper nav-menu-on">
      <ul class="navigation-container--nested-nav-wrapper--nested-nav">
        {% for nav_item in site.data.top_nav.items %}
          <li>
            {%- unless nav_item.children -%}
              {%- assign nested_nav_item_wrapper_classname = "nested-nav--top-menu-item--wrapper__without-children" -%}
            {%- else -%}
              {%- assign nested_nav_item_wrapper_classname = "nested-nav-top-menu-item--wrapper__has_children" -%}
            {%- endunless -%}
            <div class="nested-nav--top-menu-item-wrapper {{nested_nav_item_wrapper_classname}}">
              <div class="nested-nav--top-menu-item-wrapper--link">
                <a {% if nav_item.url %} href="{{ nav_item.url }}" {% else %} href="#" {% endif %}
                  {% if nav_item.fragments contains url_fragment or nav_item.fragment == url_fragment %} class="in-category" {% endif %}
                >{{ nav_item.label }}</a>
              </div>
              {%- if nav_item.children -%}
                <div class="nested-nav--top-menu-item-wrapper--toggle">
                  <div class="opensearch-toggle-button--wrapper">
                      <a href="#" class="opensearch-toggle-button-link opensearch-toggle-button-link--untoggled opensearch-toggle-button-link__visible">
                        <svg width="30" height="31" viewBox="0 0 30 31" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <rect y="14" width="30" height="3" fill="#0085B8"/>
                          <rect x="13.5" y="30.5" width="30" height="3" transform="rotate(-90 13.5 30.5)" fill="#0085B8"/>
                        </svg>
                      </a>
                      <a href="#" class="opensearch-toggle-button-link opensearch-toggle-button-link--toggled opensearch-toggle-button-link__invisible">
                        <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <rect y="13.5" width="30" height="3" fill="#0085B8"/>
                        </svg>
                      </a>
                  </div>
                </div>
              {%- endif -%}
            </div>
            {% if nav_item.children %}
              <ul>
                {% for nav_child in nav_item.children %}
                  {%- if nav_child.url contains '://' -%}
                    {%- assign child_url_fragment = '#' -%}
                  {%- else -%}
                    {%- assign child_url_parts = nav_child.url | split: "/" -%}
                    {% assign last_child_url_part = child_url_parts | last %}
                    {% if last_child_url_part contains ".html" %}
                      {% assign child_url_has_filename = true %}
                    {% else %}
                      {% assign child_url_has_filename = false %}
                    {% endif %}
                    {% if last_child_url_part == 'index.html' %}
                      {% assign child_url_filename_is_index = true %}
                    {% else %}
                      {% assign child_url_filename_is_index = false %}
                    {% endif %}
                    {% if is_conference_page %}
                      {% if child_url_has_filename %}
                        {% assign child_url_fragment_index = child_url_parts | size | minus: 2 %}
                        {% assign child_url_fragment = child_url_parts[child_url_fragment_index] %}
                      {% else %}
                        {% assign child_url_fragment = last_child_url_part %}
                      {% endif %}
                    {% else %}
                      {% if child_url_has_filename %}
                        {% unless child_url_filename_is_index %}
                          {% assign child_url_fragment = last_child_url_part | replace: ".html", "" %}
                        {% else %}
                          {% assign child_url_fragment_index = child_url_parts | size | minus: 2 %}
                          {% assign child_url_fragment = child_url_parts[child_url_fragment_index] %}
                        {% endunless %}
                      {% else %}
                        {% assign child_url_fragment = last_child_url_part %}
                      {% endif %}
                    {% endif %}
                  {%- endif -%}
                  <li>
                    <a href="{{ nav_child.url }}"
                      {% if page.url == nav_child.url -%}
                        class="in-category"
                      {%- elsif child_url_fragment == url_fragment -%}
                        class="in-category"
                      {%- endif %}
                    >{{ nav_child.label }}</a>
                  </li>
                {% endfor %}
              </ul>
            {% endif %}
          </li>
        {% endfor %}
        <li class="top-banner-search">
          <div class="top-banner-search--field-with-results">
            <div class="top-banner-search--field-with-results--field">
              <div class="top-banner-search--field-with-results--field--wrapper">
                <div class="top-banner-search--field-with-results--field--wrapper--search-component">
                  <div class="top-banner-search--field-with-results--field--wrapper--search-component--input-wrap">
                    <input type="text" id="search-input" class="top-banner-search--field-with-results--field--wrapper--search-component--search-input"
                      placeholder="Search for anything" aria-label="Search {{ site.title }}"
                      data-docs-version="latest" autocomplete="off"
                    >
                    <div class="top-banner-search--field-with-results--field--wrapper--search-component--search-spinner"><i></i></div>
                    <label for="search-input" class="top-banner-search--field-with-results--field--wrapper--search-component--search-label">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="top-banner-search--field-with-results--field--wrapper--search-component--search-icon" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
                        <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                      </svg>
                    </label>
                  </div>
                  <div id="search-results" class="top-banner-search--field-with-results--field--wrapper--search-component--search-results">
                    <div class="top-banner-search--field-with-results--field--wrapper--search-component--search-results-wrapper"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="top-banner-search--overlay"></div>
        </li>
      </ul>
    </div>
  </div>
</div>
<script type="module">
  document.addEventListener('DOMContentLoaded', () => {
    const menu = document.querySelector('#top .nav-menu-on');
    const button = document.querySelector('#top .menu-button');
    button.addEventListener('click', () => {
        menu.classList.toggle('active');
        button.classList.toggle('active');
    });
  });
  document.addEventListener('DOMContentLoaded', () => {
    function getSubMenu(button) {
        const parentLI = button.closest('li');
        const childUL = parentLI.querySelector('ul');
        return childUL;
    }
    function initializeCustomMenuHeights(button) {
        const childUL = getSubMenu(button);
        const height = childUL?.scrollHeight;
        childUL?.style?.setProperty?.('--expanded-height', `${height}px`);
        childUL?.classList?.add?.('nested-nav--menu__mobile-hidden-collapsed');
    }
    function onNestedNavMenuTransitionEnd(e) {
        const { target } = e;
        if (!target?.hasAttribute?.('expanded')) {
            target?.classList.add('nested-nav--menu__mobile-hidden-collapsed');
        }
    }

    function onToggleButtonClick(e) {
        const visibleClassName = 'opensearch-toggle-button-link__visible';
        const visibleSelector = `.${visibleClassName}`;
        const invisibleClassName = 'opensearch-toggle-button-link__invisible';
        const invisibleSelector = `.${invisibleClassName}`;

        const toggle = e.currentTarget;
        const visibleLink = toggle.querySelector(visibleSelector);
        const invisibleLink = toggle.querySelector(invisibleSelector);
        visibleLink.classList.remove(visibleClassName);
        visibleLink.classList.add(invisibleClassName);
        invisibleLink.classList.remove(invisibleClassName);
        invisibleLink.classList.add(visibleClassName);

        const childUL = getSubMenu(toggle);
        const isAlreadyExpanded = childUL?.getAttribute?.('expanded') ?? false;
        if (childUL.classList.contains('nested-nav--menu__mobile-hidden-collapsed')) {
            childUL?.classList?.remove?.('nested-nav--menu__mobile-hidden-collapsed');
        }
        window.setTimeout(() => childUL?.toggleAttribute?.('expanded'), 60);
    }

    document.querySelector('#top .navigation-container--nested-nav-wrapper--nested-nav')?.addEventListener?.('transitionend', onNestedNavMenuTransitionEnd);
    const topNavigationToggleButtons = document.querySelectorAll('#top .opensearch-toggle-button--wrapper');
    for (let i = 0; i < topNavigationToggleButtons.length; ++i) {
        const button = topNavigationToggleButtons[i];
        initializeCustomMenuHeights(button);
        button.addEventListener('click', onToggleButtonClick);
    }
  });
</script>
